Биржевой стакан.
Описание заявки.

Вам необходим разработать систему трейдинга.

В систему поступают заявки. 

Заявки двух типов: выставить заявку и убрать с торгов.

Каждая заявки имеет эммитента. Это поле указывает идентификатор ценной бумаги.

Например. Мы ходим купить Акции ГазПрома. Мы посылаем заявку на приобретение акций ГазПрома.

Ниже описание всех полей заявки

id - уникальный ключ заявки.

book - идентификатор ценной бумаги.

type - add/delete - выставить заявку на торги или снять

action - bid/ask - заявка имеет два действия. Заявка на покупка ценной бумаги или на продажу.

price - цена, по которой мы ходим сделать действия покупки или продажи.

volume - количество акций, которые мы хотим продать или купить.

 

Действия системы.

1. В системы должны быть стаканы - Это списки всех заявок относящиеся к одному эммитенту.

2. Когда в систему пришла заявка, надо определить в какому стакану она принадлежит.

3. Далее по типу заявки. Если заявка на снятие с торгов нужно ее удалить из стакана.

4. Если заявка на добавления. Нужно ее добавить в стакан.

Процесс добавления заявки в стакан.

Стакан - это заявки одного эммитента упорядоченные по убыванию цены.

1. Сначала заявки нужно сгруппировать по принципу - покупка. продажа. То есть у вас будет два списка. 

2. Заявки нужно держать по убывания цены. Сначала заявки с самой большой ценной.

Процесс продажи/покупки.

1. После того. когда заявка попадает в стакан, нужно понять. нет ли в стакане заявки противоположного действия, которое можно совместить.

Например. Приходит заявка на покупку 10 акций ГазПром по цене 11 рублей. 

В стакане есть заявки на продажу 9 акций ГазПрома по цене 10 рублей.

В этом случае мы видим. что можем эти заявки совместить. мы можем продать 9 акций по цене 10 рублей. клиенту, который хочет купить 10 акций по удобной для него цене.

В этом случае мы вычитаем объемы. Если у заявки объем 0. мы убираем ее из стакана.

Если больше 0. то оставляем. но уменьшаем объем.

Процесс отображение стакана.

1. Для пользователя системы не важно сколько заявок пришло в систему. для него важно количество акций на покупку и продажу.

Поэтому когда мы выводим стакан, мы должны показать три столбика

Продажа Цена Покупка

 

Первый столбец мы заполняем количеством заявок на покупку.

Третий столбик мы заполняем количеством заявок на продажу.

Центральный столбей отображает цены.

2. Если у заявки одинаковая цена, эти заявки нужно отображать как одну со сложенной суммой количества акций.

Например. 

Две заявки на покупку по цене 10 рублей. одна на 45 акций. вторая на 16.

В стакане отображаем одну строку 

Покупку Цена 

61         10